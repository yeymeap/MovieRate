<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MovieRate.ViewModels"
             xmlns:models="using:MovieRate.Models"
             xmlns:views="using:MovieRate.Views"
             x:Class="MovieRate.Views.HomeView"
             x:DataType="vm:HomeViewModel">

  <Grid ColumnDefinitions="260,*">

    <!-- Sidebar -->
    <Border Grid.Column="0" Background="#1e1e1e" Padding="16">
      <Grid RowDefinitions="Auto,*,Auto">

        <!-- App Title -->
        <TextBlock Grid.Row="0"
                   Text="MovieRate"
                   FontSize="22"
                   FontWeight="Bold"
                   Margin="0 0 0 24"/>

        <!-- Lists -->
        <ScrollViewer Grid.Row="1">
          <StackPanel Spacing="4">
            <TextBlock Text="MY LISTS"
                       FontSize="11"
                       Opacity="0.5"
                       Margin="0 0 0 8"/>

            <ProgressBar IsIndeterminate="True"
                         IsVisible="{Binding IsLoading}"
                         Height="2"
                         Margin="0 0 0 8"/>

            <ItemsControl ItemsSource="{Binding Lists}">
              <ItemsControl.ItemTemplate>
                <DataTemplate DataType="models:MovieList">
                  <Grid ColumnDefinitions="*,Auto,Auto" Margin="0 2">
                    <Button Grid.Column="0"
                            Content="{Binding Name}"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Left"
                            Command="{Binding $parent[UserControl].((vm:HomeViewModel)DataContext).SelectListCommand}"
                            CommandParameter="{Binding}"
                            Classes="Flat"/>
                    <Button Grid.Column="1"
                            Content="⇗"
                            Command="{Binding $parent[UserControl].((vm:HomeViewModel)DataContext).StartShareCommand}"
                            CommandParameter="{Binding}"
                            Classes="Flat"
                            Opacity="0.5"
                            Padding="4"
                            ToolTip.Tip="Share list"/>
                    <Button Grid.Column="2"
                            Content="✕"
                            Command="{Binding $parent[UserControl].((vm:HomeViewModel)DataContext).DeleteListCommand}"
                            CommandParameter="{Binding}"
                            Classes="Flat"
                            Opacity="0.5"
                            Padding="4"/>
                  </Grid>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>

          </StackPanel>
        </ScrollViewer>

        <!-- Bottom Section -->
        <StackPanel Grid.Row="2" Spacing="8">

          <!-- Share Panel -->
          <Border IsVisible="{Binding ListToShare, Converter={x:Static ObjectConverters.IsNotNull}}"
                  Background="#2a2a2a"
                  CornerRadius="8"
                  Padding="12">
            <StackPanel Spacing="8">
              <TextBlock Text="{Binding ListToShare.Name, StringFormat='Share: {0}'}"
                         FontWeight="SemiBold"
                         FontSize="12"/>
              <TextBox Watermark="Friend's email..."
                       Text="{Binding ShareEmail}"/>
              <TextBlock Text="{Binding ShareMessage}"
                         FontSize="11"
                         TextWrapping="Wrap"
                         IsVisible="{Binding ShareMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
              <Grid ColumnDefinitions="*,Auto">
                <Button Grid.Column="0"
                        Content="Share"
                        Command="{Binding ShareListCommand}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Center"
                        Margin="0 0 4 0"/>
                <Button Grid.Column="1"
                        Content="✕"
                        Command="{Binding CancelShareCommand}"
                        Classes="Flat"
                        Opacity="0.5"/>
              </Grid>
            </StackPanel>
          </Border>

          <TextBox Watermark="New list name..."
                   Text="{Binding NewListName}"/>
          <Button Content="Create List"
                  Command="{Binding CreateListCommand}"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"/>
          <Button Content="Logout"
                  Command="{Binding LogoutCommand}"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  Opacity="0.6"/>
        </StackPanel>

      </Grid>
    </Border>

    <!-- Main Content -->
    <Panel Grid.Column="1">
      <TextBlock Text="Select a list or create a new one"
                 Opacity="0.4"
                 FontSize="16"
                 HorizontalAlignment="Center"
                 VerticalAlignment="Center"
                 IsVisible="{Binding SelectedList, Converter={x:Static ObjectConverters.IsNull}}"/>
      <ContentControl Content="{Binding SelectedList}">
        <ContentControl.DataTemplates>
          <DataTemplate DataType="vm:ListViewModel">
            <views:ListView/>
          </DataTemplate>
        </ContentControl.DataTemplates>
      </ContentControl>
    </Panel>

  </Grid>

</UserControl>